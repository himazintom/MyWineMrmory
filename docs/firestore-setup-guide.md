# Firestore Database ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

## ğŸ—ï¸ 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆæ‰‹é †

### Step 1: Firebase Console ã«ã‚¢ã‚¯ã‚»ã‚¹
1. [Firebase Console](https://console.firebase.google.com) ã‚’é–‹ã
2. `MyWineMemory` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ

### Step 2: Firestore Database ã‚’ä½œæˆ
1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒFirestore Databaseã€ã‚’é¸æŠ
2. ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

### Step 3: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’é¸æŠ
**é–‹ç™ºç”¨ï¼ˆæ¨å¥¨ï¼‰:**
```
ğŸ”“ ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã§é–‹å§‹
```
- 30æ—¥é–“æœ‰åŠ¹
- èªè¨¼ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨

**æœ¬ç•ªç”¨:**
```
ğŸ”’ æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã§é–‹å§‹
```
- å³æ ¼ãªãƒ«ãƒ¼ãƒ«
- æœ€åˆã‹ã‚‰ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’è¨­å®š

### Step 4: ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠ
**æ¨å¥¨:** `asia-northeast1 (Tokyo)`
- æ—¥æœ¬ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒé«˜é€Ÿ
- ãƒ‡ãƒ¼ã‚¿ä¿ç®¡å ´æ‰€ãŒæ—¥æœ¬

## ğŸ“‹ 2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«è¨­å®š

### é–‹ç™ºç”¨ãƒ«ãƒ¼ãƒ«ï¼ˆç°¡å˜ï¼‰
Firebase Console â†’ Firestore Database â†’ ãƒ«ãƒ¼ãƒ«ï¼š

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}
```

### æœ¬ç•ªç”¨ãƒ«ãƒ¼ãƒ«ï¼ˆå®‰å…¨ï¼‰
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
      
      match /wines/{wineId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
        
        match /records/{recordId} {
          allow read, write: if request.auth != null && request.auth.uid == userId;
        }
      }
    }
  }
}
```

## ğŸ—‚ï¸ 3. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ç¢ºèª

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```
users/{userId}
â”œâ”€â”€ displayName: "ç”°ä¸­å¤ªéƒ"
â”œâ”€â”€ email: "tanaka@example.com"
â”œâ”€â”€ createdAt: 2024-01-15T10:00:00.000Z
â””â”€â”€ preferences: {
    theme: "light",
    language: "ja"
}
```

### ãƒ¯ã‚¤ãƒ³æƒ…å ±
```
users/{userId}/wines/{wineId}
â”œâ”€â”€ wineName: "ã‚·ãƒ£ãƒˆãƒ¼ãƒ»ãƒãƒ«ã‚´ãƒ¼"
â”œâ”€â”€ producer: "ã‚·ãƒ£ãƒˆãƒ¼ãƒ»ãƒãƒ«ã‚´ãƒ¼"
â”œâ”€â”€ country: "ãƒ•ãƒ©ãƒ³ã‚¹"
â”œâ”€â”€ region: "ãƒœãƒ«ãƒ‰ãƒ¼"
â”œâ”€â”€ wineType: "red"
â”œâ”€â”€ recordCount: 3
â”œâ”€â”€ avgRating: 4.5
â””â”€â”€ createdAt: 2024-01-15T10:00:00.000Z
```

### ãƒ†ã‚¤ã‚¹ãƒ†ã‚£ãƒ³ã‚°è¨˜éŒ²
```
users/{userId}/wines/{wineId}/records/{recordId}
â”œâ”€â”€ recordDate: "2024-01-15"
â”œâ”€â”€ wineRating: 5
â”œâ”€â”€ pairingRating: 4
â”œâ”€â”€ notes: "ç´ æ™´ã‚‰ã—ã„ãƒ¯ã‚¤ãƒ³"
â”œâ”€â”€ aroma: {
â”‚   scores: { fruit: 9, floral: 3, ... },
â”‚   detailed: { fruit: ["ã‚«ã‚·ã‚¹", "ãƒ—ãƒ©ãƒ "], ... }
â”‚ }
â”œâ”€â”€ taste: {
â”‚   attack: { intensity: "strong", notes: "..." },
â”‚   finish: { length: "very_long", seconds: 45 }
â”‚ }
â””â”€â”€ createdAt: 2024-01-15T19:00:00.000Z
```

## ğŸ”§ 4. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ

### è‡ªå‹•ä½œæˆã•ã‚Œã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
ã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€FirebaseãŒè‡ªå‹•çš„ã«å¿…è¦ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ææ¡ˆã—ã¾ã™ã€‚

### æ‰‹å‹•ä½œæˆãŒå¿…è¦ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
Firebase Console â†’ Firestore Database â†’ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼š

```
ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³: users/{userId}/wines
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: updatedAt (é™é †), wineName (æ˜‡é †)

ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³: users/{userId}/wines/{wineId}/records  
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: recordDate (é™é †)

ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³: users/{userId}/wines/{wineId}/records
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: wineRating (é™é †), recordDate (é™é †)
```

## ğŸ§ª 5. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

### æ–¹æ³•1: ã‚¢ãƒ—ãƒªã‹ã‚‰ä½œæˆ
1. ã‚¢ãƒ—ãƒªã«ãƒ­ã‚°ã‚¤ãƒ³
2. ã€Œæ–°ã—ã„ãƒ¯ã‚¤ãƒ³ã‚’è¨˜éŒ²ã€ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 

### æ–¹æ³•2: Firebase Consoleã‹ã‚‰æ‰‹å‹•ä½œæˆ
1. Firestore Database â†’ ãƒ‡ãƒ¼ã‚¿
2. ã€Œã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã€
3. ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ID: `users`
4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID: ã‚ãªãŸã®UID
5. ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 

## âš ï¸ 6. æ³¨æ„äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **æœ¬ç•ªç’°å¢ƒã§ã¯å¿…ãšæœ¬ç•ªç”¨ãƒ«ãƒ¼ãƒ«**ã‚’ä½¿ç”¨
- APIã‚­ãƒ¼ã¯ç’°å¢ƒå¤‰æ•°ã§ç®¡ç†
- å®šæœŸçš„ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’è¦‹ç›´ã—

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®å ´åˆã¯ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¿…é ˆ
- è¤‡åˆã‚¯ã‚¨ãƒªã«ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå¿…è¦
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒªã‚¹ãƒŠãƒ¼ã¯å¿…è¦æœ€å°é™ã«

### ã‚³ã‚¹ãƒˆ
- èª­ã¿å–ã‚Šãƒ»æ›¸ãè¾¼ã¿ãƒ»å‰Šé™¤ã”ã¨ã«èª²é‡‘
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã§ã‚‚èª²é‡‘
- [Firebaseæ–™é‡‘è¨ˆç®—ãƒ„ãƒ¼ãƒ«](https://firebase.google.com/pricing)ã§è¦‹ç©ã‚‚ã‚Š

## ğŸš€ 7. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ** âœ…
2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«è¨­å®š** âœ…  
3. **Authenticationè¨­å®š** (èªè¨¼ãƒ‰ãƒ¡ã‚¤ãƒ³è¿½åŠ )
4. **ã‚¢ãƒ—ãƒªã§ãƒ†ã‚¹ãƒˆ** (ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ‡ãƒ¼ã‚¿ä½œæˆ)
5. **æœ¬ç•ªç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«**ã«å¤‰æ›´